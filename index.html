<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>三角洲随机对局</title>
  <link rel="icon" type="image/x-icon" href="./img/xjq.jpg">
  <meta name="robots" content="index,follow">
  <link rel="stylesheet" href="css/indexStyle.css">

</head>
<body>
<div class="container">
  <h1>🎲 三角洲随机对局</h1>
  <div class="global-controls">
    <button class="global-draw-btn" id="globalDrawBtn" onclick="drawAll()">一键抽取</button>
  </div>
  <div class="sections-container">
    <div class="section-row">
      <div class="section">
        <h2 class="section-title">干员选择</h2>
        <div class="controls">
          <button id="drawBtn1" onclick="drawWinner1()">开始抽取</button>
          <button id="resetBtn1" onclick="resetHistory1()">清空历史</button>
        </div>
        <div class="result" id="result1">
          <div class="loading">请抽取你本局的干员</div>
        </div>
        <div class="history">
          <h3>历史记录</h3>
          <div class="history-list" id="historyList1">
            <div class="history-item">暂无历史记录</div>
          </div>
        </div>
      </div>
      <div class="section">
        <h2 class="section-title">地图选择</h2>
        <div class="controls">
          <button id="drawBtn2" onclick="drawWinner2()">开始抽取</button>
          <button id="resetBtn2" onclick="resetHistory2()">清空历史</button>
        </div>
        <div class="result" id="result2">
          <div class="loading">请选择你本局的地图</div>
        </div>
        <div class="history">
          <h3>历史记录</h3>
          <div class="history-list" id="historyList2">
            <div class="history-item">暂无历史记录</div>
          </div>
        </div>
      </div>
      <div class="section">
        <h2 class="section-title">头盔选择</h2>
        <div class="controls">
          <button id="drawBtn3" onclick="drawWinner3()">开始抽取</button>
          <button id="resetBtn3" onclick="resetHistory3()">清空历史</button>
        </div>
        <div class="result" id="result3">
          <div class="loading">请选择本局头盔</div>
        </div>
        <div class="history">
          <h3>历史记录</h3>
          <div class="history-list" id="historyList3">
            <div class="history-item">暂无历史记录</div>
          </div>
        </div>
      </div>
    </div>


    <div class="section-row">

      <div class="section">
        <h2 class="section-title">护甲选择</h2>
        <div class="controls">
          <button id="drawBtn4" onclick="drawWinner4()">开始抽取</button>
          <button id="resetBtn4" onclick="resetHistory4()">清空历史</button>
        </div>
        <div class="result" id="result4">
          <img src="img/img_4/1.png" class="winner-image" alt="中奖图片" onerror="this.src='https://via.placeholder.com/300x200?text=图片加载失败'">
          <div class="success-message">🎉 第四轮抽取完成！🎉</div>
        </div>
        <div class="history">
          <h3>历史记录</h3>
          <div class="history-list" id="historyList4">
            <div class="history-item">
              <img src="img/img_4/1.png" class="history-image" alt="历史图片" onerror="this.style.display='none'">
              <span>2025/8/31 20:45:00</span>
            </div>
          </div>
        </div>
      </div>

      <!-- 第五个抽取板块 -->
      <div class="section">
        <h2 class="section-title">枪械选择</h2>
        <div class="controls">
          <button id="drawBtn5" onclick="drawWinner5()">开始抽取</button>
          <button id="resetBtn5" onclick="resetHistory5()">清空历史</button>
        </div>
        <div class="result" id="result5">
          <div class="loading">请抽取你本局的枪械</div>
        </div>
        <div class="history">
          <h3>历史记录</h3>
          <div class="history-list" id="historyList5">
            <div class="history-item">暂无历史记录</div>
          </div>
        </div>
      </div>


      <div class="section">
        <h2 class="section-title">获胜条件</h2>
        <div class="controls">
          <button id="drawBtn6" onclick="drawWinner6()">开始抽取</button>
          <button id="resetBtn6" onclick="resetHistory6()">清空历史</button>
        </div>
        <div class="result" id="result6">
          <div class="evacuate-section">
            <div class="evacuate-title">撤离费用抽取 (0-1000万)</div>
            <div class="evacuate-result" id="evacuateResult">🎲 点击开始抽取</div>
          </div>
          <div class="gun-section">
            <div class="gun-title">改枪费用抽取 (0-100万)</div>
            <div class="gun-result" id="gunResult">🎲 点击开始抽取</div>
          </div>
          <div class="success-message" id="successMessage6" style="display: none;">🎉 第六轮抽取完成！</div>
        </div>
        <div class="history">
          <h3>历史记录</h3>
          <div class="history-list" id="historyList6">
            <div class="history-item">暂无历史记录</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>

  let drawHistory1 = [];
  let drawHistory2 = [];
  let drawHistory3 = [];
  let drawHistory4 = [];
  let drawHistory5 = [];
  let drawHistory6 = []; // 新增


  let participants1 = [];
  let participants2 = [];
  let participants3 = [];
  let participants4 = [];
  let participants5 = [];

  /**
   * 全局抽取函数
   */
  function drawAll() {
    // 禁用全局按钮
    const globalBtn = document.getElementById('globalDrawBtn');
    globalBtn.disabled = true;
    globalBtn.textContent = '抽取中...';

    // 禁用所有单独的抽取按钮
    for (let i = 1; i <= 6; i++) {
      const btn = document.getElementById(`drawBtn${i}`);
      if (btn) btn.disabled = true;
    }

    // 依次执行所有抽取
    drawWinner1();
    drawWinner2();
    drawWinner3();
    drawWinner4();
    drawWinner5();
    drawWinner6();

    // 启用全局按钮（延迟一点时间确保所有抽取完成）
    setTimeout(() => {
      globalBtn.disabled = false;
      globalBtn.textContent = '一键抽取';

      // 重新启用所有单独的抽取按钮
      for (let i = 1; i <= 6; i++) {
        const btn = document.getElementById(`drawBtn${i}`);
        if (btn) btn.disabled = false;
      }
    }, 2500);
  }

  /**
   * 初始化：加载第一个文件夹的所有图片
   */
  function init1() {
    const imageFiles1 = [
      'dg.png', 'fy.png', 'hl.png', 'ln.png', 'mxw.png',
      'myr.png', 'ny.png', 'wl.png', 'wll.png', 'wm.png', 'zj.png'
    ];

    for (let i = 0; i < imageFiles1.length; i++) {
      participants1.push(`img/img_1/${imageFiles1[i]}`);
    }

    document.getElementById('result1').innerHTML = `<div class="loading">已加载 ${participants1.length} 张图片，可以开始抽取了</div>`;
  }

  /**
   * 初始化：加载第二个文件夹的所有图片
   */
  function init2() {
    const imageFiles2 = [
      '普坝.png', '机坝.png', '机巴.png', '机航.png',
      '监狱.png', '绝巴.png', '绝航.png'
    ];

    for (let i = 0; i < imageFiles2.length; i++) {
      participants2.push(`img/img_2/${imageFiles2[i]}`);
    }

    document.getElementById('result2').innerHTML = `<div class="loading">已加载 ${participants2.length} 张图片，可以开始抽取了</div>`;
  }

  /**
   * 初始化：加载第三个文件夹的所有图片
   */
  function init3() {
    const imageFiles3 = [
      'T_1.png', 'T_2.png', 'T_3.png', 'T_4.png', 'T_5.png',
      'T_6.png', 'T_7.png', 'T_8.png', 'T_9.png', 'T_10.png',
      'T_11.png', 'T_12.png', 'T_13.png', 'T_14.png', 'T_15.png',
      'T_16.png', 'T_17.png', 'T_18.png', 'T_19.png', 'T_20.png',
      'T_21.png', 'T_22.png', 'T_23.png'
    ];

    for (let i = 0; i < imageFiles3.length; i++) {
      participants3.push(`img/img_3/${imageFiles3[i]}`);
    }

    document.getElementById('result3').innerHTML = `<div class="loading">已加载 ${participants3.length} 张图片，可以开始抽取了</div>`;
  }

  /**
   * 初始化：加载第四个文件夹的所有图片
   */
  function init4() {
    const imageFiles4 = [
      '1.png', '2.png', '3.png', '4.png', '5.png',
      '6.png', '7.png', '8.png', '9.png', '10.png',
      '11.png', '12.png', '13.png', '14.png', '15.png',
      '16.png', '17.png', '18.png', '19.png', '20.png',
      '21.png', '22.png'
    ];

    for (let i = 0; i < imageFiles4.length; i++) {
      participants4.push(`img/img_4/${imageFiles4[i]}`);
    }

    document.getElementById('result4').innerHTML = `<div class="loading">已加载 ${participants4.length} 张图片，可以开始抽取了</div>`;
  }

  /**
   * 初始化：加载第五个文件夹的所有图片
   */
  function init5() {
    const imageFiles5 = [];
    for (let i = 1; i <= 50; i++) {
      imageFiles5.push(`Q${i}.png`);
    }

    for (let i = 0; i < imageFiles5.length; i++) {
      participants5.push(`img/img_5/${imageFiles5[i]}`);
    }

    document.getElementById('result5').innerHTML = `<div class="loading">已加载 ${participants5.length} 张图片，可以开始抽取了</div>`;
  }

  function drawWinner1() {
    if (participants1.length === 0) {
      alert('没有找到图片！');
      return;
    }

    document.getElementById('drawBtn1').disabled = true;
    const resultDiv = document.getElementById('result1');
    resultDiv.innerHTML = '<div class="winner">🎲 抽取中...</div>';

    let count = 0;
    const maxCount = 20;
    const interval = setInterval(() => {
      resultDiv.innerHTML = '<div class="winner">🎲 抽取中...</div>';
      count++;

      if (count >= maxCount) {
        clearInterval(interval);
        const winnerIndex = Math.floor(Math.random() * participants1.length);
        const winner = participants1[winnerIndex];

        resultDiv.innerHTML = `
          <img src="${winner}" class="winner-image" alt="中奖图片" onerror="this.src='https://via.placeholder.com/300x200?text=图片加载失败'">
          <div class="winner">
            🎉 第一轮抽取完成！🎉
          </div>
        `;

        addToHistory1(winner);
        document.getElementById('drawBtn1').disabled = false;
      }
    }, 100);
  }


  function drawWinner2() {
    if (participants2.length === 0) {
      alert('没有找到图片！');
      return;
    }

    document.getElementById('drawBtn2').disabled = true;
    const resultDiv = document.getElementById('result2');
    resultDiv.innerHTML = '<div class="winner">🎲 抽取中...</div>';

    let count = 0;
    const maxCount = 20;
    const interval = setInterval(() => {
      resultDiv.innerHTML = '<div class="winner">🎲 抽取中...</div>';
      count++;

      if (count >= maxCount) {
        clearInterval(interval);
        const winnerIndex = Math.floor(Math.random() * participants2.length);
        const winner = participants2[winnerIndex];

        resultDiv.innerHTML = `
          <img src="${winner}" class="winner-image" alt="中奖图片" onerror="this.src='https://via.placeholder.com/300x200?text=图片加载失败'">
          <div class="winner">
            🎉 第二轮抽取完成！🎉
          </div>
        `;

        addToHistory2(winner);
        document.getElementById('drawBtn2').disabled = false;
      }
    }, 100);
  }


  function drawWinner3() {
    if (participants3.length === 0) {
      alert('没有找到图片！');
      return;
    }

    document.getElementById('drawBtn3').disabled = true;
    const resultDiv = document.getElementById('result3');
    resultDiv.innerHTML = '<div class="winner">🎲 抽取中...</div>';

    let count = 0;
    const maxCount = 20;
    const interval = setInterval(() => {
      resultDiv.innerHTML = '<div class="winner">🎲 抽取中...</div>';
      count++;

      if (count >= maxCount) {
        clearInterval(interval);
        const winnerIndex = Math.floor(Math.random() * participants3.length);
        const winner = participants3[winnerIndex];

        resultDiv.innerHTML = `
          <img src="${winner}" class="winner-image" alt="中奖图片" onerror="this.src='https://via.placeholder.com/300x200?text=图片加载失败'">
          <div class="winner">
            🎉 第三轮抽取完成！🎉
          </div>
        `;

        addToHistory3(winner);
        document.getElementById('drawBtn3').disabled = false;
      }
    }, 100);
  }

  /**
   * 执行第四个抽取
   */
  function drawWinner4() {
    if (participants4.length === 0) {
      alert('没有找到图片！');
      return;
    }

    document.getElementById('drawBtn4').disabled = true;
    const resultDiv = document.getElementById('result4');
    resultDiv.innerHTML = '<div class="winner">🎲 抽取中...</div>';

    let count = 0;
    const maxCount = 20;
    const interval = setInterval(() => {
      resultDiv.innerHTML = '<div class="winner">🎲 抽取中...</div>';
      count++;

      if (count >= maxCount) {
        clearInterval(interval);
        const winnerIndex = Math.floor(Math.random() * participants4.length);
        const winner = participants4[winnerIndex];

        resultDiv.innerHTML = `
          <img src="${winner}" class="winner-image" alt="中奖图片" onerror="this.src='https://via.placeholder.com/300x200?text=图片加载失败'">
          <div class="success-message">🎉 第四轮抽取完成！🎉</div>
        `;

        addToHistory4(winner);
        document.getElementById('drawBtn4').disabled = false;
      }
    }, 100);
  }

  /**
   * 执行第五个抽取
   */
  function drawWinner5() {
    if (participants5.length === 0) {
      alert('没有找到图片！');
      return;
    }

    document.getElementById('drawBtn5').disabled = true;
    const resultDiv = document.getElementById('result5');
    resultDiv.innerHTML = '<div class="winner">🎲 抽取中...</div>';

    let count = 0;
    const maxCount = 20;
    const interval = setInterval(() => {
      resultDiv.innerHTML = '<div class="winner">🎲 抽取中...</div>';
      count++;

      if (count >= maxCount) {
        clearInterval(interval);
        const winnerIndex = Math.floor(Math.random() * participants5.length);
        const winner = participants5[winnerIndex];

        resultDiv.innerHTML = `
          <img src="${winner}" class="winner-image" alt="中奖图片" onerror="this.src='https://via.placeholder.com/300x200?text=图片加载失败'">
          <div class="success-message">🎉 第五轮抽取完成！🎉</div>
        `;

        addToHistory5(winner);
        document.getElementById('drawBtn5').disabled = false;
      }
    }, 100);
  }

  /**
   * 执行第六个抽取（费用抽取）
   */
  function drawWinner6() {
    document.getElementById('drawBtn6').disabled = true;

    // 显示抽取中动画
    const evacuateResult = document.getElementById('evacuateResult');
    const gunResult = document.getElementById('gunResult');
    const successMessage = document.getElementById('successMessage6');

    // 隐藏成功消息
    successMessage.style.display = 'none';

    evacuateResult.innerHTML = '🎲 抽取中...';
    gunResult.innerHTML = '🎲 抽取中...';

    let count = 0;
    const maxCount = 20;
    const interval = setInterval(() => {
      evacuateResult.innerHTML = '🎲 抽取中...';
      gunResult.innerHTML = '🎲 抽取中...';
      count++;

      if (count >= maxCount) {
        clearInterval(interval);

        // 生成随机费用
        const evacuateFee = Math.floor(Math.random() * 1001); // 0-1000万
        const gunFee = Math.floor(Math.random() * 101); // 0-100万

        // 显示结果
        evacuateResult.innerHTML = `💰 ${evacuateFee} 万`;
        gunResult.innerHTML = `🔫 ${gunFee} 万`;

        // 显示成功消息
        successMessage.style.display = 'flex';

        // 添加到历史记录
        addToHistory6(evacuateFee, gunFee);

        document.getElementById('drawBtn6').disabled = false;
      }
    }, 100);
  }

  /**
   * 添加第一个抽取的中奖记录到历史
   */
  function addToHistory1(winner) {
    const timestamp = new Date().toLocaleString();
    drawHistory1.unshift({
      image: winner,
      timestamp: timestamp
    });
    updateHistoryDisplay1();
  }

  /**
   * 添加第二个抽取的中奖记录到历史
   */
  function addToHistory2(winner) {
    const timestamp = new Date().toLocaleString();
    drawHistory2.unshift({
      image: winner,
      timestamp: timestamp
    });
    updateHistoryDisplay2();
  }

  /**
   * 添加第三个抽取的中奖记录到历史
   */
  function addToHistory3(winner) {
    const timestamp = new Date().toLocaleString();
    drawHistory3.unshift({
      image: winner,
      timestamp: timestamp
    });
    updateHistoryDisplay3();
  }

  /**
   * 添加第四个抽取的中奖记录到历史
   */
  function addToHistory4(winner) {
    const timestamp = new Date().toLocaleString();
    drawHistory4.unshift({
      image: winner,
      timestamp: timestamp
    });
    updateHistoryDisplay4();
  }

  /**
   * 添加第五个抽取的中奖记录到历史
   */
  function addTo抽取History5(winner) {
    const timestamp = new Date().toLocaleString();
    drawHistory5.unshift({
      image: winner,
      timestamp: timestamp
    });
    updateHistoryDisplay5();
  }

  /**
   * 添加第六个抽取的费用记录到历史
   */
  function addToHistory6(evacuateFee, gunFee) {
    const timestamp = new Date().toLocaleString();
    drawHistory6.unshift({
      evacuateFee: evacuateFee,
      gunFee: gunFee,
      timestamp: timestamp
    });
    updateHistoryDisplay6();
  }

  /**
   * 更新第一个抽取的历史记录显示
   */
  function updateHistoryDisplay1() {
    const historyList = document.getElementById('historyList1');
    if (drawHistory1.length === 0) {
      historyList.innerHTML = '<div class="history-item">暂无抽取记录</div>';
      return;
    }

    let historyHTML = '';
    for (let i = 0; i < drawHistory1.length; i++) {
      const item = drawHistory1[i];
      historyHTML += `
        <div class="history-item">
          <img src="${item.image}" class="history-image" alt="历史图片" onerror="this.style.display='none'">
          <span>${item.timestamp}</span>
        </div>
      `;
    }

    historyList.innerHTML = historyHTML;
  }

  /**
   * 更新第二个抽取的历史记录显示
   */
  function updateHistoryDisplay2() {
    const historyList = document.getElementById('historyList2');
    if (drawHistory2.length === 0) {
      historyList.innerHTML = '<div class="history-item">暂无抽取记录</div>';
      return;
    }

    let historyHTML = '';
    for (let i = 0; i < drawHistory2.length; i++) {
      const item = drawHistory2[i];
      historyHTML += `
        <div class="history-item">
          <img src="${item.image}" class="history-image" alt="历史图片" onerror="this.style.display='none'">
          <span>${item.timestamp}</span>
        </div>
      `;
    }

    historyList.innerHTML = historyHTML;
  }

  /**
   * 更新第三个抽取的历史记录显示
   */
  function updateHistoryDisplay3() {
    const historyList = document.getElementById('historyList3');
    if (drawHistory3.length === 0) {
      historyList.innerHTML = '<div class="history-item">暂无抽取记录</div>';
      return;
    }

    let historyHTML = '';
    for (let i = 0; i < drawHistory3.length; i++) {
      const item = drawHistory3[i];
      historyHTML += `
        <div class="history-item">
          <img src="${item.image}" class="history-image" alt="历史图片" onerror="this.style.display='none'">
          <span>${item.timestamp}</span>
        </div>
      `;
    }

    historyList.innerHTML = historyHTML;
  }

  /**
   * 更新第四个抽取的历史记录显示
   */
  function updateHistoryDisplay4() {
    const historyList = document.getElementById('historyList4');
    if (drawHistory4.length === 0) {
      historyList.innerHTML = '<div class="history-item">暂无抽取记录</div>';
      return;
    }

    let historyHTML = '';
    for (let i = 0; i < drawHistory4.length; i++) {
      const item = drawHistory4[i];
      historyHTML += `
        <div class="history-item">
          <img src="${item.image}" class="history-image" alt="历史图片" onerror="this.style.display='none'">
          <span>${item.timestamp}</span>
        </div>
      `;
    }

    historyList.innerHTML = historyHTML;
  }

  /**
   * 更新第五个抽取的历史记录显示
   */
  function updateHistoryDisplay5() {
    const historyList = document.getElementById('historyList5');
    if (drawHistory5.length === 0) {
      historyList.innerHTML = '<div class="history-item">暂无抽取记录</div>';
      return;
    }

    let historyHTML = '';
    for (let i = 0; i < drawHistory5.length; i++) {
      const item = drawHistory5[i];
      historyHTML += `
        <div class="history-item">
          <img src="${item.image}" class="history-image" alt="历史图片" onerror="this.style.display='none'">
          <span>${item.timestamp}</span>
        </div>
      `;
    }

    historyList.innerHTML = historyHTML;
  }

  /**
   * 更新第六个抽取的历史记录显示
   */
  function updateHistoryDisplay6() {
    const historyList = document.getElementById('historyList6');
    if (drawHistory6.length === 0) {
      historyList.innerHTML = '<div class="history-item">暂无抽取记录</div>';
      return;
    }

    let historyHTML = '';
    for (let i = 0; i < drawHistory6.length; i++) {
      const item = drawHistory6[i];
      historyHTML += `
        <div class="history-item">
          <span>撤离: ${item.evacuateFee}万 | 改枪: ${item.gunFee}万</span>
          <span> - ${item.timestamp}</span>
        </div>
      `;
    }

    historyList.innerHTML = historyHTML;
  }

  /**
   * 清空第一个抽取抽取抽取的历史
   */
  function resetHistory1() {
    if (confirm('确定要清空第一轮抽取抽取抽取的历史记录吗？')) {
      drawHistory1 = [];
      updateHistoryDisplay1();
    }
  }

  /**
   * 清空第二个抽取抽取抽取的历史
   */
  function resetHistory2() {
    if (confirm('确定要清空第二轮抽取抽取抽取的历史记录吗？')) {
      drawHistory2 = [];
      updateHistoryDisplay2();
    }
  }

  /**
   * 清空第三个抽取抽取的历史
   */
  function resetHistory3() {
    if (confirm('确定要清空第三轮抽取抽取的历史记录吗？')) {
      drawHistory3 = [];
      updateHistoryDisplay3();
    }
  }

  /**
   * 清空第四个抽取抽取的历史
   */
  function resetHistory4() {
    if (confirm('确定要清空第四轮抽取抽取的历史记录吗？')) {
      drawHistory4 = [];
      updateHistoryDisplay4();
    }
  }

  /**
   * 清空第五个抽取抽取的历史
   */
  function resetHistory5() {
    if (confirm('确定要清空第五轮抽取抽取的历史记录吗？')) {
      drawHistory5 = [];
      updateHistoryDisplay5();
    }
  }

  /**
   * 清空第六个抽取的历史
   */
  function resetHistory6() {
    if (confirm('确定要清空第六轮抽取的历史记录吗？')) {
      drawHistory6 = [];
      updateHistoryDisplay6();
    }
  }

  // 页面加载完成后初始化所有抽取板块
  window.onload = function() {
    init1();
    init2();
    init3();
    init4();
    init5();
    updateHistoryDisplay1();
    updateHistoryDisplay2();
    updateHistoryDisplay3();
    updateHistoryDisplay4();
    updateHistoryDisplay5();
    updateHistoryDisplay6();
  };
</script>
</body>
</html>
